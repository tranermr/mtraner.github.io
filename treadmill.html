<!DOCTYPE HTML>
<!--
	Phantom by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Small-Animal VR Treadmill</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="wrapper-article">
				<!-- Nav Header -->

				<!-- Main -->
					<div id="main-article">
						<!-- <div class="inner"> -->
							<h3>Small-Animal VR Odor-Trail Treadmill</h3>
							<div class="image">
								<img src="images/treadmillMain.jpg" alt="" class="custimg_sm">
							</div>
							<b>Background:</b>
							<p>Understanding how organisms use olfactory information (smells) to navigate is an important component to either implementing cyborg sensors or mimicking biological approaches. The odorants that are used for navigation can be broken down into two broad categories: airborne, like the scents when you pass by a restaurant, and surface-bound, where the odorants are affixed to a surface, such as ant trails.</p>
							<p>Surface-bound odorants have been studied less compared to airborne-plume odorant studies, but have unique characteristics that make them an interesting approach for studying olfactory-guided navigation. The three most-important differences are that the concentrations of odorants along odor trails remain fairly constant, whereas airborne plumes dissipate rapidly, and change concentration as you move along the plume; that surface-bound trails are easier to define, and so it may be possible to leverage analysis of observed sampling and following behaviors for more insight into the underlying mechanisms of the search strategies; and that mechanical disturbance of surface-bound odorants can increase the concentration available to sample (e.g. sniffing or patting with antennae). </p>
							<p>The development of the treadmill to improve the quality of the data and partially automate collection proceeded through a number of phases, culminating in the submission of a <a href="https://www.biorxiv.org/content/10.1101/2023.02.22.529569v1.full.pdf" style="font-weight:normal; text-decoration:underline"> paper</a> and the release of the final design as an <a href="https://github.com/tranermr/Surface-Bound-Odorant-Treadmill" style="font-weight:normal; text-decoration:underline">open-source project</a>.</p>
							<!-- <video width="320" height="240" style="display: block; margin-left: auto; margin-right: auto;" controls> -->
							<video class="video_sm" muted="muted" controls>
								<source src="/images/EarlyLocustTest.mov">
							</video>
							<p></p>
							<b>Phase 1: Identification of the problem</b>
							<p>The challenges of studying surface-bound odor trail interactions became apparent when we began to test whether locusts could engage in trail following. </p>
							<ul style="padding-left:40px">
							<li>Locusts are agitated by handling and often would flee from the area with the odor trail before engaging with it. </li>
							<li>Locusts are much larger than ants, so providing a large arena with a trail for them to explore was impractical. However, a smaller arena limits the amount of trail that can be explored, and therefore the data that can be gained each trial.</li>
							<li>Setup and cleaning was time intensive, consuming large amounts of time between trials and constraining the pace of data collection.</li>
							</ul>
							<p>To address these issues I conceived of a treadmill behavioral arena, where the locusts could interact with a trail while the belt slowly advanced to open up more trail to explore, forming the base off which the design was refined in phase 2.</p>
							<b>Phase 2: Planning</b>
							<p>The most obvious path was to look for a commercial off-the-shelf (COTS) solution or preexisting open-source designs. However, no commercial options existed, and only two studies had used similar designs. <a style="font-weight:normal; text-decoration:underline" href="https://doi.org/10.1038/ncomms1712">One by Khan et al.</a> used premade trails and ran at a constant speed, which would caused issues with locusts that move sporadically (reference). The other was referenced in Mathis et al’s 2018 <a style="font-weight:normal; text-decoration:underline" href="https://www.nature.com/articles/s41593-018-0209-y">Deep Lab Cut paper</a>, but the data and design have not been published. As a result, it was necessary to develop my own design.</p>
							<p>To begin I developed a list of challenges, and requirements for features to address them:</p>
							<ul style="padding-left:40px">
							<li>Capacity for larger animals/arena	 -> Treadmill-based design</li>
							<li>Animal odor residue might alter results 	-> Disposable surface (single use paper towel)</li>
							<li>Dynamically generate odor trail		-> Print trail on-demand</li>
							<li>Print patterns				-> Movable printhead</li>
							<li>Locusts move sporadically		-> Closed loop control based on locust position</li>
							<li>Encourage ascent of treadmill 		-> Slope to use negative gravitaxis to encourage upward movement, and slippery sides to prevent climbing the walls instead of the floor</li>
							</ul>
							<p>Once the requirements and initial designs had been developed, prototyping of components and the full system could begin.</p>
							<div class="image">
								<img src="images/treadmillAtHome.jpg" class="custimg_sm">
							</div>
							<b>Phase 3: Prototyping and development</b>
							<p>The first phase of development involved prototyping multiple sub-systems. This was made more difficult by the work being performed during the early phase of COVID, with associated supply challenges. Furthermore, campus was closed, and so most development work was carried out in my dining room or at a local makerspace during open hours. The most challenging system to develop was the print mechanism for depositing odorant to form the trail. I prototyped and tested a number of competing approaches, including:</p>
							<ul style="padding-left:40px">
							<li>Modifying ink cartridges to deposit odorants</li>
							<li>Use of a peristaltic pump to deposit measured amounts of odorants</li>
							<li>Using a piezoelectric- or piston-based chamber attached to a nozzle and fed with odorant solution, driving out solution by the actuation displacing odorant through the nozzle</li>
							<li>Using a solenoid to release pulses of odorant solution from a pressurized reservoir through a nozzle</li>
							</ul>
							<p>The first solution of modifying an ink cartridge would be the most accurate and straightforward, but was discarded because one odorant we wished to test was a colony odor derived from cage leavings using dichloromethane. Dichloromethane is an aggressive solvent, making it excellent for extracting chemical compounds, but it would also destroy any print cartridge used.</p>
							<p>The second solution would have been straightforward, but the flexible tubing integral to peristaltic pumps was not sufficiently resistant to dichloromethane, and no sufficiently resistant but flexible material could be found.</p>
							<p>I developed prototypes for the third solution, but found that the movement of the actuator would produce air bubbles in the high-vapor pressure dichloromethane, and that the variation in compressibility of the bubbles meant inconsistent amounts of odorant would be released. Furthermore, it was challenging to construct mechanisms that were robust enough to survive the dichloromethane solvent.</p>
							<p>The third solution proved to be the most effective, and ultimately a design using a pressurized solution in a Cole-Parmer flask and gated by a Clippard solenoid valve was selected. In addition to meeting the response time requirements, the Clippard valve had the advantage of being the only suitable valve I could locate with less than a one-year backorder.</p>
							<p>The other most complex components were the driving mechanism and print carriage assembly. To simplify construction, I modified the components from an HP Photosmart C6180 inkjet printer, repurposing the print carriage the paper feed mechanism to drive the paper towel. In order to evaluate the position I took advantage of the optical quadrature encoders already incorporated into the mechanisms. However, the high-speed of the pulses when operating at the speeds required went too fast for a software solution on the Teensy 3.5 microcontroller I was using, frequently missing steps. Instead, I used the hardware-based quadrature decoders to monitor the position, periodically sampling and resetting the buffer to prevent overflow. Once the electrical components had been mocked up and rendered functional, the mechanical design was addressed.</p>
							<p>The full mechanical design was drafted on CAD, incorporating mountings for  Plexiglass components cut using the laser cutter at the local <a href="https://archreactor.org/" style="font-weight:normal; text-decoration:underline"> Arch Reactor makerspace </a>. Extruded aluminum components were cut using a hacksaw, and 3D printed elements were printed on my personal 3D printer. Initial electrical designs and subsequent modifications were tested on breadboards before being committed to custom PCB designs.</p>
							<!-- <video width="360" height="640" style="display: block; margin-left: auto; margin-right: auto;" muted="muted" controls> -->
							<!-- <video width="30%" style="display: block; margin-left: auto; margin-right: auto;" muted="muted" controls> -->
							<video class="video_sm" muted="muted" controls>
								<source src="/images/locustWalkingOnTreadmill.mp4">
							</video>
							<p></p>
							<b>Phase 4: Testing and Iteration</b>
							<p>The treadmill was extensively tested prior to use, beginning with black “pseudo locusts” to verify tracking, printing, and paper-towel movement performance, during which a number of issues were rectified. It was then tested using locusts, and test data collected using a zig-zag pattern, and the performance and data analyzed to refine the trial process. </p>
							<p>One particularly confusing bug encountered at this point was periodic false positives on a limit switch, and occasional embedded controller restarts. Ultimately this was traced to a buildup of static electricity due to the movement of the paper towel, and was addressed by a combination of mechanical (limiting of plastic surfaces the paper towel slid over) and electrical revisions (additional grounding and shielding of some cables, incorporation of opto-isolation to protect the core microcontroller from any static that might affect other components, and software revisions to unexpected limit switch triggers).</p>
							<div class="image">
								<img src="images/PCBLayout.png" alt="" class="custimg_med">
							</div> 
							<p>Other revisions during this period included mechanical protection over the drive mechanism to prevent the paper towel from becoming entangled, implementation of a more precise and stable alignment system for the paper towel to prevent lateral drift during operation, and the revision of most components to modular assemblies for easier movement and greater flexibility for future iterations. </p>
							
							<b>Phase 5: Operation and Release</b>
							<p>For the purposes of the proof-of-concept study evaluating trail-following behavior in locusts, it was decided to use straight lines in the middle of the arena rather than more complex patterns. I selected a final panel of 24 odorants, combining promising odorants from the early-phase tests with panels used in other lab studies. The study process had been refined to measure a single odor and control condition each day for multiple locusts, reducing the time needed to flush the odorant system after switching odorants, and the colony was sufficiently robust to handle the large number of locusts I would require. </p>
							<p>I then collected over 600 hours of locust movement data, and analyzed them to evaluate trail following behavior and modulation of exploratory behavior by odor proximity (see paper preprint for details), before writing up the results and submitting a paper. </p>
							<p>I also performed final revision of the treadmill design, incorporating some additional fixes and features, and published it as an open-source project. While the design could have been revised further, it was sufficient for our purposes, and will provide a useful starting point for future studies. Useful features not incorporated in the final design and suggestions on how to add them (such as a second printhead or a reward mechanism for conditioning) are discussed in the design document, along with considerations for building. </p>
							<div class="image">
								<img src="images/TreadmillPublishedDesign.png" alt="" class="custimg_full">
								<!-- <img src="images/TreadmillPublishedDesign.png" alt="" style="display: block; margin-left: auto; margin-right: auto; width: 100%;"> -->
							</div>
						<!-- </div> -->
					</div>

				<!-- Footer -->
					<footer id="footer-article">
						<div class="inner">
							<ul class="copyright">
								<li>&copy; 2024 Michael R. Traner. All rights reserved.</li>
							</ul>
						</div>
					</footer>

			</div>

		<!-- BG -->
			<div id="bg-article"></div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>